---
import Newsletter from './Newsletter.astro';
import { type Locale } from '@/lib/i18n';
import { localizePath } from '@/lib/locale-path';
import { getAllTools } from '@/lib/tools-data';
import Icon from '@/components/ui/Icon.astro';
import { getI18n } from '@/utils/i18n';
import EvolutionHubLogo from 'public/assets/svg/evolutionhub-mark.svg';
import { getSocialLinks } from '@/config/social';

interface Props {
  hideNewsletter?: boolean;
  locale?: Locale;
}

const { hideNewsletter = true, locale = 'de' as Locale } = Astro.props;
const t = getI18n(locale);
const socialLinks = getSocialLinks();

const cookieSlug: Record<Locale, string> = {
  de: 'cookie-einstellungen',
  en: 'cookie-settings',
};

const allTools = getAllTools(locale);
const rank = (id: string) =>
  id === 'Imag-Enhancer'
    ? 0
    : id === 'prompt-enhancer'
      ? 1
      : id === 'webscraper'
        ? 2
        : id === 'voice-visualizer'
          ? 3
          : 99;
const footerTools = allTools
  .filter((t) => !t.comingSoon)
  .slice()
  .sort((a, b) => rank(a.id) - rank(b.id));
---

<footer class="relative glass-footer bg-transparent" role="contentinfo">
  <!-- Decorative elements -->
  <div class="absolute inset-0 overflow-hidden z-0">
    <div
      class="absolute inset-0 bg-gradient-to-b from-gray-900/90 to-black/90"
      aria-hidden="true"
    >
    </div>
    <div
      class="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJub25lIi8+CiAgPHBhdGggZD0iTTAgMEgxMDBWMTBIMFYwWk0wIDkwSDEwMFYxMDBIMFY5MFpNMCA0NUgxMDBWNTVIMFY0NVpNNDUgMEg1NVYxMEg0NVYwWk00NSA0NUg1NVY1NUg0NVY0NVpNNDUgOTBINTVWMTAwSDQ1VjkwWk0wIDIyLjVIMTAwVjMyLjVIMFYyMi41Wk0wIDY3LjVIMTAwVjc3LjVINlY2Ny41WiIgZmlsbD0icmdiYSgxNiwxODUsMTQ4LDAuMDUpIi8+Cjwvc3ZnPg==')] opacity-20"
    >
    </div>
  </div>

  <div
    class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 z-10 text-slate-500 dark:text-slate-400"
  >
    <!-- Main Footer Content - 4 Columns -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-12">
      <!-- Brand & Description -->
      <div class="space-y-4 lg:col-span-2 md:col-span-2">
        <a
          href={localizePath(locale, '/')}
          class="flex items-center space-x-3 group hover:opacity-90 transition"
          aria-label="Evolution Hub Home"
        >
          <EvolutionHubLogo class="w-10 h-10" />
          <span class="sr-only">Evolution Hub</span>
        </a>
        <p class="text-sm leading-relaxed">{t('footer.claim')}</p>

        <!-- Social Links -->
        <div class="flex space-x-3 pt-2">
          {socialLinks.github && (
            <a href={socialLinks.github} class="text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200" aria-label="GitHub" target="_blank" rel="noopener noreferrer">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.699 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg>
            </a>
          )}
          {socialLinks.x && (
            <a href={socialLinks.x} class="text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200" aria-label="X" target="_blank" rel="noopener noreferrer">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 3H21l-6.52 7.46L22 21h-6.78l-4.24-5.19L5.9 21H3.14l7.06-8.07L2 3h6.86l3.84 4.73L18.24 3zm-1.19 16h1.63L7.04 5H5.35l11.71 14z"/></svg>
            </a>
          )}
          {socialLinks.reddit && (
            <a href={socialLinks.reddit} class="text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200" aria-label="Reddit" target="_blank" rel="noopener noreferrer">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M14.5 15.5c-.66 0-1.2-.54-1.2-1.2s.54-1.2 1.2-1.2 1.2.54 1.2 1.2-.54 1.2-1.2 1.2zm-5 0c-.66 0-1.2-.54-1.2-1.2s.54-1.2 1.2-1.2 1.2.54 1.2 1.2-.54 1.2-1.2 1.2z"/><path d="M22 12c0-1.1-.9-2-2-2-.6 0-1.13.26-1.5.67-1.15-.73-2.65-1.2-4.33-1.3l.73-3.43 2.38.5c.06.87.78 1.56 1.67 1.56.93 0 1.68-.75 1.68-1.68S20.88 4.62 19.95 4.62c-.6 0-1.13.31-1.43.78l-2.85-.6c-.19-.04-.38.09-.42.28l-.86 4.03c-1.76.02-3.36.49-4.56 1.23A2 2 0 004 10c-1.1 0-2 .9-2 2 0 .74.4 1.38 1 1.73-.02.18-.03.37-.03.56 0 2.49 3.13 4.51 7 4.51s7-2.02 7-4.51c0-.19-.01-.38-.03-.56.6-.35 1.03-.99 1.03-1.73zM8.5 17.2c1.02.68 2.47 1.11 4.08 1.11s3.06-.43 4.08-1.11c.17-.12.2-.34.08-.5a.36.36 0 00-.5-.08c-.9.6-2.2.98-3.66.98s-2.76-.38-3.66-.98a.36.36 0 00-.5.08c-.12.16-.09.38.08.5z"/></svg>
            </a>
          )}
          {socialLinks.tiktok && (
            <a href={socialLinks.tiktok} class="text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200" aria-label="TikTok" target="_blank" rel="noopener noreferrer">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M13.5 3h2.2c.25 1.6 1.28 2.97 2.7 3.7A7.6 7.6 0 0020 7.7v2.1a6.9 6.9 0 01-3.7-1.2v5.1c0 3.2-2.6 5.8-5.8 5.8S4.7 16.9 4.7 13.7s2.6-5.8 5.8-5.8c.3 0 .6 0 .9.1v2.3c-.3-.1-.6-.2-.9-.2-2 0-3.6 1.7-3.6 3.6s1.6 3.6 3.6 3.6 3.6-1.6 3.6-3.6V3z"/></svg>
            </a>
          )}
          {socialLinks.instagram && (
            <a href={socialLinks.instagram} class="text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200" aria-label="Instagram" target="_blank" rel="noopener noreferrer">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5zm5 5a5 5 0 100 10 5 5 0 000-10zm6-1a1 1 0 100 2 1 1 0 000-2z"/></svg>
            </a>
          )}
          {socialLinks.linkedin && (
            <a href={socialLinks.linkedin} class="text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200" aria-label="LinkedIn" target="_blank" rel="noopener noreferrer">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0H5C2.8 0 1 1.8 1 4v16c0 2.2 1.8 4 4 4h14c2.2 0 4-1.8 4-4V4c0-2.2-1.8-4-4-4zM8.3 19H5.6V9.3h2.7V19zM7 8.1c-.9 0-1.6-.8-1.6-1.7S6.1 4.7 7 4.7s1.6.8 1.6 1.7S7.9 8.1 7 8.1zM20 19h-2.7v-5.1c0-1.2-.4-2-1.5-2s-1.7.8-1.7 2V19h-2.7V9.3h2.6v1.3c.4-.8 1.5-1.4 2.6-1.4 2 0 3.4 1.3 3.4 4.1V19z"/></svg>
            </a>
          )}
          {socialLinks.pinterest && (
            <a href={socialLinks.pinterest} class="text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200" aria-label="Pinterest" target="_blank" rel="noopener noreferrer">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 00-3.6 19.3c-.1-.8-.2-2 .1-2.8.2-.8 1.5-5 1.5-5s-.4-.8-.4-2c0-1.9 1.1-3.2 2.4-3.2 1.2 0 1.9.9 1.9 2.1 0 1.3-.9 3.2-1.3 5-.4 1.5.7 2.8 2.2 2.8 2.7 0 4.8-2.8 4.8-6.9 0-3.6-2.6-6.1-6.3-6.1-4.3 0-6.8 3.2-6.8 6.4 0 1.3.5 2.7 1.1 3.5.1.1.1.1 0 .3-.1.3-.4 1-.5 1.1-.1.2-.2.3-.4.2-1.4-.6-2.3-2.6-2.3-4.2 0-3.5 2.5-6.8 7.6-6.8 4 0 7.2 2.8 7.2 6.7 0 4-2.5 7.2-6 7.2-1.2 0-2.3-.6-2.7-1.4 0 0-.6 2.4-.8 2.9-.3 1.1-1 2.2-1.6 3.1A10 10 0 1012 2z"/></svg>
            </a>
          )}
        </div>
      </div>

      <!-- Quick Links -->
      <nav aria-labelledby="footer-quick-links">
        <h3 id="footer-quick-links" class="text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider mb-2">{t('footer.quick')}</h3>
        <ul class="space-y-3">
          <li>
            <a
              href={localizePath(locale, '/dashboard')}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                ></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200"
                >Dashboard</span
              >
            </a>
          </li>
          <li>
            <a
              href={localizePath(locale, '/blog')}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"
                ></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200">Blog</span>
            </a>
          </li>
          <!-- removed: Projekte link (page not available) -->
          <li>
            <a
              href={localizePath(locale, '/docs')}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200"
                >Dokumentation</span
              >
            </a>
          </li>
          <li>
            <a
              href={localizePath(locale, '/faq')}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 10a4 4 0 118 0c0 2-2 3-4 3m0 4h.01"></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200">FAQ</span>
            </a>
          </li>
          <li>
            <a
              href={localizePath(locale, '/kontakt')}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                ></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200"
                >Kontakt</span
              >
            </a>
          </li>
        </ul>
      </nav>

      <!-- Ressourcen section removed (pages not available) -->

      <!-- Rechtliches -->
      <nav aria-labelledby="footer-legal">
        <h3 id="footer-legal" class="text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider mb-2">{t('footer.legal')}</h3>
        <ul class="space-y-3">
          <li>
            <a
              href={localizePath(locale, '/datenschutz')}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"
                ></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200"
                >Datenschutzerklärung</span
              >
            </a>
          </li>
          <li>
            <a
              href={localizePath(locale, '/impressum')}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
                ></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200"
                >Impressum</span
              >
            </a>
          </li>
          <li>
            <a
              href={localizePath(locale, '/agb')}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200">AGB</span>
            </a>
          </li>
          <li>
            <a
              href={localizePath(locale, `/${cookieSlug[locale]}`)}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200">{t('footer.cookie_settings')}</span>
            </a>
          </li>
        </ul>
      </nav>
      <!-- Tools -->
      <div>
        <h3
          id="footer-tools-heading"
          class="text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider mb-2"
        >
          {t('footer.tools')}
        </h3>
        <ul class="space-y-3" aria-labelledby="footer-tools-heading">
          <li>
            <a
              href={localizePath(locale, '/tools')}
              class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
            >
              <svg
                class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"></path>
              </svg>
              <span class="group-hover:translate-x-1 transition-transform duration-200"
                >{t('pages.tools.categories.all') || 'Alle Tools'}</span
              >
            </a>
          </li>
          {
            footerTools.map((tool) => (
              <li>
                <a
                  href={localizePath(locale, tool.url)}
                  class="flex items-center text-current hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200 group"
                >
                  {tool.iconKey ? (
                    <Icon
                      name={tool.iconKey}
                      class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                      ariaLabel={tool.name}
                    />
                  ) : (
                    <svg
                      class="w-4 h-4 mr-2 text-current transition-transform duration-200 group-hover:translate-x-1"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 16l4-4 4 4 8-8"
                      />
                    </svg>
                  )}
                  <span class="group-hover:translate-x-1 transition-transform duration-200">
                    {tool.name}
                  </span>
                </a>
              </li>
            ))
          }
        </ul>
      </div>
    </div>

    {!hideNewsletter && <Newsletter />}

    <!-- Copyright Bar -->
    <div class="border-t border-gray-200 dark:border-gray-700 mt-6 pt-4 text-center">
      <p class="text-sm text-gray-500 dark:text-gray-400">{t('footer.copyright')}</p>
    </div>
  </div>
</footer>
