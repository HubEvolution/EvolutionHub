# URL-basierte Internationalisierung (i18n)

## Übersicht

Dieses Projekt verwendet eine einfache, URL-basierte Internationalisierungslogik, um zwischen den Sprachen Deutsch (`de`) und Englisch (`en`) zu wechseln. Die Sprache wird anhand des Pfadpräfixes in der URL bestimmt.

## Implementierung

### Kern-Utility-Funktionen

Die Logik ist in [`src/lib/i18n.ts`](file:///Users/lucas/Downloads/EvolutionHub_Bundle_v1.7_full/evolution-hub/src/lib/i18n.ts) (Locale-Erkennung & Navigation) und
in [`src/utils/i18n.ts`](file:///Users/lucas/Downloads/EvolutionHub_Bundle_v1.7_full/evolution-hub/src/utils/i18n.ts) (Übersetzungen) implementiert:

1. **`getLocale(pathname: string): 'de' | 'en'`**
  - Extrahiert das Locale aus dem URL-Pfad.
  - Pfade, die mit `/de/` beginnen, werden als Deutsch erkannt.
  - Pfade, die mit `/en/` beginnen, werden als Englisch erkannt.
  - Alle anderen Pfade werden standardmäßig als Deutsch behandelt.

2. **`navigateLocale(locale: 'de' | 'en'): void`**
  - Wechselt die Sprache durch Programmierung der Navigation.
  - Ersetzt oder fügt das Locale-Präfix im aktuellen Pfad hinzu.
  - Verwendet `window.location.assign()` für die Navigation.

3. **`getI18n(locale: 'de' | 'en'): (key: string) => string`**
  - Liefert eine Translator-Funktion zurück, die mit einem Dot-Path arbeitet, z. B. `t('pages.home.hero.title')`.
  - Fallback auf Englisch, wenn ein Schlüssel im aktuellen Locale fehlt.
  - Rückgabe immer als `string`; bei fehlenden Schlüsseln wird ein Platzhalter wie `[de:pages.foo_fallback_not_found]` zurückgegeben.

#### Migrationshinweis

* Der bisherige Default-Export aus `@/lib/i18n` wurde entfernt. Verwende nur benannte Exporte
  (`getLocale`, `navigateLocale`) und für Übersetzungen `getI18n(locale)` aus `@/utils/i18n`.
* Achtung: `getI18n(locale)` liefert eine Funktion zurück. Nicht mit `{ t } = getI18n(...)` arbeiten,
  sondern: `const t = getI18n(locale);` und dann `t('…')` verwenden.

### Frontend-Integration

#### Sprachumschalter im Header

In [`src/components/Header.astro`](file:///Users/lucas/Downloads/EvolutionHub_Bundle_v1.7_full/evolution-hub/src/components/Header.astro) wird der Sprachumschalter implementiert:

- Importiert die i18n-Funktionen: `import { getLocale, navigateLocale } from '@/lib/i18n';`
- Bestimmt das aktuelle Locale: `const currentLocale = getLocale(Astro.url.pathname);`
- Implementiert den Umschaltmechanismus:
  - Zeigt das aktuelle Locale im Button an.
  - Verwendet ARIA-Attribute für Barrierefreiheit.
  - Wechselt beim Klick die Sprache mit `navigateLocale()`.

#### Dynamisches `<html lang>` und `hreflang`-Links

In [`src/layouts/BaseLayout.astro`](file:///Users/lucas/Downloads/EvolutionHub_Bundle_v1.7_full/evolution-hub/src/layouts/BaseLayout.astro) werden die Sprachattribute dynamisch gesetzt:

- Importiert die i18n-Funktion: `import { getLocale } from '@/lib/i18n';`
- Setzt das `<html lang>`-Attribut basierend auf der URL: `<html lang={getLocale(Astro.url.pathname)} class="h-full">`
- Fügt `hreflang`-Links für SEO hinzu:
  - `<link rel="alternate" hreflang="de" href={`${Astro.url.origin}/de${Astro.url.pathname.replace(/^\/(de|en)/, '')}`} />`
  - `<link rel="alternate" hreflang="en" href={`${Astro.url.origin}/en${Astro.url.pathname.replace(/^\/(de|en)/, '')}`} />`

## Unit-Tests

Unit-Tests für die i18n-Funktionen sind in [`src/lib/i18n.test.ts`](file:///Users/lucas/Downloads/EvolutionHub_Bundle_v1.7_full/evolution-hub/src/lib/i18n.test.ts) implementiert und verwenden Vitest.