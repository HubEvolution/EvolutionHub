name = "mcp-hub-admin"
main = "src/index.ts"
compatibility_date = "2025-07-26"
compatibility_flags = ["nodejs_compat"]
account_id = "39434b5635d8beb4bde93e1792b628d7"
workers_dev = false
preview_urls = false

[observability.logs]
enabled = true

[vars]
# Base URL of the Hub API (no trailing slash)
HUB_BASE_URL = "https://hub-evolution.com"

# Allowed hosts/origins for DNS rebinding protection on the MCP endpoint.
ALLOWED_HOSTS = "mcp.hub-evolution.com"
ALLOWED_ORIGINS = "https://mcp.hub-evolution.com"

# Session ID generation mode for MCP transport.
ENABLE_STATEFUL_SESSIONS = "0"

# Secrets to set via `wrangler secret put`:
#   HUB_ADMIN_TOKEN   (Bearer token for /api/admin/*)
#   CONFIRM_SECRET    (HMAC secret for confirm tokens)

[env.production]
name = "mcp-hub-admin"
workers_dev = false
preview_urls = false
routes = ["mcp.hub-evolution.com/*"]

[env.production.vars]
HUB_BASE_URL = "https://hub-evolution.com"
ALLOWED_HOSTS = "mcp.hub-evolution.com"
ALLOWED_ORIGINS = "https://mcp.hub-evolution.com"
ENABLE_STATEFUL_SESSIONS = "0"

[env.staging]
name = "mcp-hub-admin-staging"
workers_dev = false
preview_urls = false
routes = ["mcp-staging.hub-evolution.com/*"]

[env.staging.vars]
HUB_BASE_URL = "https://staging.hub-evolution.com"
ALLOWED_HOSTS = "mcp-staging.hub-evolution.com"
ALLOWED_ORIGINS = "https://mcp-staging.hub-evolution.com"
ENABLE_STATEFUL_SESSIONS = "0"

# Secrets per env:
#   wrangler secret put HUB_ADMIN_TOKEN --env staging
#   wrangler secret put CONFIRM_SECRET --env staging
